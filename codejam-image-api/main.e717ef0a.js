parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"efV4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getLinkToImage=n,exports.drawOnCanvas=a,exports.calcProportions=t;var e=require("./main");function t(e,t,a,n){var r=e/t;if(1===r)return{x:0,y:0,width:a,height:n};if(r>1){var c=t/e;return{x:0,y:(n-n*c)/2,width:a,height:n*c}}return r<1?{x:(a-a*r)/2,y:0,width:a*r,height:n}:void 0}function a(a){var n=new Image;n.crossOrigin="Anonymous",n.src=a,n.onload=function(){var a=t(n.width,n.height,e.canvas.canvas.width,e.canvas.canvas.height);e.canvas.ctx.drawImage(n,a.x,a.y,a.width,a.height),localStorage.image||localStorage.setItem("image",e.canvas.canvas.toDataURL())}}function n(e){var t,n;return regeneratorRuntime.async(function(r){for(;;)switch(r.prev=r.next){case 0:return t="https://api.unsplash.com/photos/random?query=town,".concat(e,"\n  &client_id=e7085d7b9f940ceb950f950cc8c4108e56165596aa1a6917f91b24c32d355b8f"),r.next=3,regeneratorRuntime.awrap(fetch(t));case 3:return n=r.sent,r.next=6,regeneratorRuntime.awrap(n.json());case 6:a(r.sent.urls.small);case 8:case"end":return r.stop()}})}
},{"./main":"KIzB"}],"UwUq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.rgbToHex=r,exports.hex=c,exports.setCurrentColor=n,exports.setActiveTool=s,exports.setCurrentSizeButton=l,exports.imageToGrayscale=i,exports.changeCanvasSettings=u,exports.prevColor=exports.currentColor=void 0;var e=require("./main"),t=require("./requests"),o=document.getElementById("current-color");exports.currentColor=o;var a=document.querySelector(".prevColor");function r(e,t,o){if(e>255||t>255||o>255)throw new Error("Invalid color component");return(e<<16|t<<8|o).toString(16)}function c(e){var t=e.split(",");return"#"+("000000"+r(Number(t[0].substring(4)),Number(t[1]),Number(t[2].slice(1,-1)))).slice(-6)}function n(e){a.style.backgroundColor=o.value,o.value=e}function s(e){document.getElementById("tools").querySelectorAll("p").forEach(function(e){return e.classList.toggle("active-tool",!1)}),document.querySelector(".".concat(e)).classList.toggle("active-tool"),"picker"===e?document.getElementById("colors").querySelectorAll("p").forEach(function(e){return e.classList.toggle("active-colors",!0)}):document.getElementById("colors").querySelectorAll("p").forEach(function(e){return e.classList.toggle("active-colors",!1)})}function l(e){document.querySelector(".btn-group").querySelectorAll("button").forEach(function(e){return e.classList.toggle("active-button",!1)}),document.querySelector(".size".concat(e)).classList.toggle("active-button")}function i(){for(var t=e.canvas.ctx.getImageData(0,0,e.canvas.canvas.width,e.canvas.canvas.height),o=t.data,a=0;a<o.length;a+=4){var r=(o[a]+o[a+1]+o[a+2])/3;o[a]=r,o[a+1]=r,o[a+2]=r}e.canvas.ctx.putImageData(t,0,0)}function u(o){switch(localStorage.pixelSize=o,e.canvas.canvas.pixelSize=o,l(o),o){case 4:e.canvas.canvas.width=128,e.canvas.canvas.height=128;break;case 2:e.canvas.canvas.width=256,e.canvas.canvas.height=256;break;case 1:e.canvas.canvas.width=512,e.canvas.canvas.height=512}localStorage.image&&((0,t.drawOnCanvas)(localStorage.image),localStorage.setItem("canvasImg",e.canvas.canvas.toDataURL()))}exports.prevColor=a;
},{"./main":"KIzB","./requests":"efV4"}],"c4sH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Canvas=void 0;var t=require("./colors");function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function n(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}var a=function(){function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:128,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:128;e(this,i),this.pixelSize=t,this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=n,this.canvas.height=a}return n(i,[{key:"defaultFill",value:function(){this.ctx.fillStyle="#FFFFFF",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}},{key:"fillSector",value:function(t,e,i){this.ctx.fillStyle=i,this.ctx.fillRect(t,e,this.pixelSize,this.pixelSize)}},{key:"colorOfCanvasPixel",value:function(e,i){var n=this.ctx.getImageData(e,i,1,1).data;return"#"+("000000"+(0,t.rgbToHex)(n[0],n[1],n[2])).slice(-6)}},{key:"getMousePos",value:function(t){var e=this.canvas.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}}]),i}();exports.Canvas=a;
},{"./colors":"UwUq"}],"KIzB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"currentColor",{enumerable:!0,get:function(){return r.currentColor}}),Object.defineProperty(exports,"prevColor",{enumerable:!0,get:function(){return r.prevColor}}),exports.canvas=void 0;var e,t,o=require("./canvas"),r=require("./colors"),a=require("./requests");function n(e,t){return s(e)||l(e,t)||c()}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function l(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var o=[],r=!0,a=!1,n=void 0;try{for(var c,l=e[Symbol.iterator]();!(r=(c=l.next()).done)&&(o.push(c.value),!t||o.length!==t);r=!0);}catch(s){a=!0,n=s}finally{try{r||null==l.return||l.return()}finally{if(a)throw n}}return o}}function s(e){if(Array.isArray(e))return e}exports.canvas=e;var i,u=!1;window.addEventListener("DOMContentLoaded",function(){if(t=localStorage.tool||"pencil",(0,r.setActiveTool)(t),r.currentColor.value=localStorage.currColor||"#008000",r.prevColor.style.backgroundColor=localStorage.preColor||"#808080",i=Number(localStorage.pixelSize)||4,localStorage.getItem("canvasImg")){exports.canvas=e=new o.Canvas(i,512/i,512/i);var a=localStorage.getItem("canvasImg"),n=new Image;n.src=a,n.onload=function(){e.ctx.drawImage(n,0,0,e.canvas.width,e.canvas.height)}}else exports.canvas=e=new o.Canvas,e.defaultFill();(0,r.setCurrentSizeButton)(i)}),window.addEventListener("beforeunload",function(){localStorage.setItem("tool",t),localStorage.setItem("currColor",r.currentColor.value),localStorage.setItem("preColor",(0,r.hex)(r.prevColor.style.backgroundColor)),localStorage.setItem("canvasImg",e.canvas.toDataURL())}),document.querySelector(".btn-group").addEventListener("click",function(e){switch(e.target.classList[2]){case"size4":i=4,(0,r.changeCanvasSettings)(i);break;case"size2":i=2,(0,r.changeCanvasSettings)(i);break;case"size1":i=1,(0,r.changeCanvasSettings)(i)}}),document.getElementById("load-button").addEventListener("click",function(){localStorage.image&&(localStorage.removeItem("image"),e.defaultFill());var t=document.getElementById("city-input").value||"Minsk";(0,a.getLinkToImage)(t)}),document.getElementById("grayscale-button").addEventListener("click",function(){localStorage.image?(0,r.imageToGrayscale)():alert("First you need upload the image :)")}),document.getElementById("tools").addEventListener("click",function(o){document.getElementById("tools").querySelectorAll("p").forEach(function(e){return e.classList.toggle("active-tool",!1)}),o.target.classList.toggle("active-tool");var r=n(o.target.classList,2)[1];"picker"===(t=r)?document.getElementById("colors").querySelectorAll("p").forEach(function(e){return e.classList.toggle("active-colors",!0)}):"clear"===t?(e.defaultFill(),localStorage.removeItem("image"),localStorage.removeItem("canvasImg")):document.getElementById("colors").querySelectorAll("p").forEach(function(e){return e.classList.toggle("active-colors",!1)})}),document.getElementById("canvas").addEventListener("mousedown",function(o){var a=e.getMousePos(o),n=Math.min(a.x/i),c=Math.min(a.y/i);switch(t){case"bucket":e.fillSector(n,c,r.currentColor.value);break;case"picker":(0,r.setCurrentColor)(e.colorOfCanvasPixel(n,c));break;case"pencil":e.ctx.beginPath(),e.ctx.moveTo(n,c),u=!0,document.getElementById("canvas").addEventListener("mousemove",function(t){if(u){var o=e.getMousePos(t);e.ctx.strokeStyle=r.currentColor.value,e.ctx.lineTo(Math.min(o.x/i),Math.min(o.y/i)),e.ctx.stroke()}}),document.getElementById("canvas").addEventListener("mouseup",function(){u&&(e.ctx.closePath(),u=!1)})}}),document.getElementById("colors").addEventListener("click",function(e){if("picker"===t)switch("current-color"===e.target.id&&(r.prevColor.style.backgroundColor=r.currentColor.value),e.target.classList[1]){case"second":(0,r.setCurrentColor)((0,r.hex)(r.prevColor.style.backgroundColor));break;case"third":(0,r.setCurrentColor)("#CD0000");break;case"fourth":(0,r.setCurrentColor)("#0000ff")}else"picker"!==t&&"current-color"===e.target.id&&e.preventDefault()}),document.addEventListener("keydown",function(e){switch(e.keyCode){case 66:t="bucket",(0,r.setActiveTool)(t);break;case 67:t="picker",(0,r.setActiveTool)(t);break;case 80:t="pencil",(0,r.setActiveTool)(t)}});
},{"./canvas":"c4sH","./colors":"UwUq","./requests":"efV4"}]},{},["KIzB"], null)
//# sourceMappingURL=main.e717ef0a.js.map